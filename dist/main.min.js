class SimpleLangSwitcher{constructor(e,a){this.version="1.0.0",this.name="SimpleLangSwitcher",this.selector=document.querySelectorAll(e),this.lang=document.documentElement.lang.split(/[-_]/)[0].toLowerCase(),this.path=document.location.pathname,this.cache=86400,this.options={defaultLang:"en",shortName:!1,title:!1,listClass:"lang-switcher",translation:{de:{languageChoice:"Sprachauswahl",languageSwitchText:"Diese Seite in {{lang}} anzeigen",languages:{de:"Deutsch",en:"Englisch",pl:"Polnisch",fr:"Franz\xF6sisch",ru:"Russisch",es:"Spanisch",it:"Italienisch"}},en:{languageChoice:"Language selection",languageSwitchText:"Display this page in {{lang}}",languages:{de:"German",en:"English",pl:"Polish",fr:"French",ru:"Russian",es:"Spanish",it:"Italian"}},pl:{languageChoice:"Wyb\xF3r j\u0119zyka",languageSwitchText:"Wy\u015Bwietl t\u0119 stron\u0119 w {{lang}}",languages:{de:"Niemiecki",en:"Angielski",pl:"Polski",fr:"Francuski",ru:"Rosyjski",es:"Hiszpa\u0144ski",it:"W\u0142oski"}},fr:{languageChoice:"Choix de la langue",languageSwitchText:"Afficher cette page en {{lang}}",languages:{de:"Allemand",en:"Anglais",pl:"Polonais",fr:"Fran\xE7ais",ru:"Russe",es:"Espagnol",it:"Italien"}},ru:{languageChoice:"\u0412\u044B\u0431\u043E\u0440 \u044F\u0437\u044B\u043A\u0430",languageSwitchText:"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C \u044D\u0442\u0443 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 \u043D\u0430 {{lang}}",languages:{de:"\u041D\u0435\u043C\u0435\u0446\u043A\u0438\u0439",en:"\u0410\u043D\u0433\u043B\u0438\u0439\u0441\u043A\u0438\u0439",pl:"\u041F\u043E\u043B\u044C\u0441\u043A\u0438\u0439",fr:"\u0424\u0440\u0430\u043D\u0446\u0443\u0437\u0441\u043A\u0438\u0439",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",es:"\u0418\u0441\u043F\u0430\u043D\u0441\u043A\u0438\u0439",it:"\u0418\u0442\u0430\u043B\u044C\u044F\u043D\u0441\u043A\u0438\u0439"}},es:{languageChoice:"Selecci\xF3n de idioma",languageSwitchText:"Mostrar esta p\xE1gina en {{lang}}",languages:{de:"Alem\xE1n",en:"Ingl\xE9s",pl:"Polaco",fr:"Franc\xE9s",ru:"Ruso",es:"Espa\xF1ol",it:"Italiano"}},it:{languageChoice:"Selezione della lingua",languageSwitchText:"Mostra questa pagina in {{lang}}",languages:{de:"Tedesco",en:"Inglese",pl:"Polacco",fr:"Francese",ru:"Russo",es:"Spagnolo",it:"Italiano"}}}},this.settings=this.merge(this.options,a),this.init()}async init(){console.log(this.getTranslation("languages.de")),this.errorCheck(this.settings.mapping)&&this.mapping()}errorCheck(e){if(!e)return this.errorMessage("Mapping Fehlt!"),!1;if(Object.keys(e).length===0)return this.errorMessage("Keine Sprachen vorhanden!"),!1;for(let a in e){if(Object.keys(e[a]).length===0)return this.errorMessage(`Die Sprache (${a.toUpperCase()}) hat keine Links!`),!1;for(let i in e[a])if(typeof e[a][i]=="string")return this.errorMessage(`Folgender IDENT <b>(${a.toUpperCase()} -> ${i} ->  ${e[a][i]})</b> als Zahl angeben!`),!1}return!0}errorMessage(e){console.log(`%c${e}`,"color: red; font-weight: bold;")}async mapping(){let e=this,a={},i,n=this.settings.mapping,s=n[this.lang];for(let t in n)a[t]={path:e.settings.defaultLang==t?"/":`/${t}/`,title:t};for(let t in s)t===e.path&&(a[e.lang].path=t,a[e.lang].title=await e.getPageTitle(e.lang,t),i=s[t]);delete n[e.lang];for(let t in n)for(let l in n[t])n[t][l]===i&&(a[t].path=l,a[t].title=await e.getPageTitle(t,l));e.selector.forEach(t=>{t.role="navigation",t.ariaLabel=this.getTranslation("languageChoice"),e.createList(t,a)})}async getPageTitle(e,a){let i=this.getTranslation(`languages.${e}`);if(this.settings.title){let n=await this.getHTML(a);n.title&&(i=n.title)}return i}createLinks(e){let a=this,i={};for(const[n,s]of Object.entries(e)){let t=document.createElement("a");t.title=s.title,t.innerText=n,t.href=s.path,t.tabIndex=0,t.ariaLabel=this.getTranslation("languageSwitchText",{lang:this.getTranslation(`languages.${n}`)}),t.lang=n,t.hreflang=n,n===this.lang&&t.setAttribute("aria-current","page"),i[n]=t}return i}createList(e,a){let i=document.createElement("ul"),n=e.getElementsByClassName(this.settings.listClass)[0];i.className=`${this.settings.listClass} page-${this.lang}`,n&&n.remove(),e.appendChild(i);for(const[s,t]of Object.entries(this.createLinks(a))){let l=document.createElement("li");l.className=s,this.settings.shortName&&(t.innerText=s),s===this.lang&&l.classList.add("active"),l.appendChild(t),i.appendChild(l)}console.log(`%c${this.name} ${this.version} wurde erfolgreich ausgef\xFChrt!`,"color: green; font-weight: bold;")}async asyncGet(e){return fetch(e,{headers:{"Cache-Control":`max-age=${this.cache}`}})}async getHTML(e){return this.asyncGet(e).then(a=>a.text()).then(a=>new DOMParser().parseFromString(a,"text/html"))}getTranslation(e,a={}){let i=this.settings.translation;if(this.lang in i){const n=e.split(".");let s=i[this.lang];for(let t of n)if(s=s[t],!s)break;for(let t in a)s=s.replace(`{{${t}}}`,a[t]);return s}return i.en!==void 0&&i.en.hasOwnProperty(e)?i.en[e]:e}merge(...e){let a={};const i=n=>{for(let s in n)n.hasOwnProperty(s)&&(Object.prototype.toString.call(n[s])==="[object Object]"?a[s]=this.merge(a[s],n[s]):a[s]=n[s])};for(let n=0;n<e.length;n++)i(e[n]);return a}}
